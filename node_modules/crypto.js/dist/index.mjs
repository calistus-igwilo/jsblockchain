import m from"os";import l from"fs";import c from"crypto";var B=["aes-128-gcm","aes-192-gcm","aes-256-gcm","aes-128-ccm","aes-192-ccm","aes-256-ccm","aes-128-ocb","aes-192-ocb","aes-256-ocb"],g=+process.versions.node.split(".").slice(0,2).join("."),h=c.scryptSync?c.scryptSync("","",16):Buffer.from("0xd7 0x2c 0x87 0xd0 0xf0 0x77 0xc7 0x76 0x6f 0x29 0x85 0xdf 0xab 0x30 0xe8 0x95".split(" ")),p={origin:c,hash(e,r,f){let t=c.createHash(e),i=Buffer.isBuffer(r);return t.update(r,i?"binary":"utf8"),t.digest(f||"hex")},hmac(e,r,f,t){f=f||"";let i=c.createHmac(e,f),u=Buffer.isBuffer(r);return i.update(r,u?"binary":"utf8"),i.digest(t||"hex")},cipher(e,r,f=h,t,i){if(g>=10.5)return this.cipheriv(e,r,f,h,t,i);t=Buffer.isBuffer(r)?"binary":t||"utf8",i=i||"base64";let s=c.createCipher(e,f),a=s.update(r,t,i);if(a+=s.final(i),B.indexOf(e)>-1){let n=s.getAuthTag();return{enStr:a,authTag:n}}return a},decipher(e,r,f=h,t,i,u){if(g>=10.5)return this.decipheriv(e,r,f,h,t,i,u);i=Buffer.isBuffer(r)?"binary":i||"base64",u=u||"utf8";let a=c.createDecipher(e,f);B.indexOf(e)>-1&&a.setAuthTag(t);let n=a.update(r,i,u);return n+=a.final(u),n},cipheriv(e,r,f=h,t=h,i,u){i=Buffer.isBuffer(r)?"binary":i||"utf8",u=u||"base64";let a=c.createCipheriv(e,f,t),n=a.update(r,i,u);if(n+=a.final(u),B.indexOf(e)>-1){let x=a.getAuthTag();return{enStr:n,authTag:x}}return n},decipheriv(e,r,f=h,t=h,i,u,s){u=Buffer.isBuffer(r)?"binary":u||"base64",s=s||"utf8";let n=c.createDecipheriv(e,f,t);B.indexOf(e)>-1&&n.setAuthTag(i);let x=n.update(r,u,s);return x+=n.final(s),x}};var b=function(e){for(let r in e){let f=e[r].pop();if(f.mac!=="00:00:00:00:00:00")return f.mac}return process.pid.toString(16)+process.ppid.toString(16)}(m.networkInterfaces()),o=1024;function A(e,r){var f,t;return Buffer.isBuffer(e)?f=e:f=Buffer.from(e+""),t=f.toString("base64"),r?t.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,""):t}function d(e,r){return r&&(e=e.replace(/-/g,"+").replace(/_/g,"/").replace(/[^A-Za-z0-9\+\/]/g,"")),Buffer.from(e,"base64")}function D(e,r){let f="qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM0123456789";r&&(f="0123456789");let t=f.length,i="";for(let u=0;u<e;u++){let s=Math.random()*t>>0;i+=f[s]}return i}function H(e="-"){var r=p.origin.randomBytes(8).toString("hex"),f=(~~(Date.now()/1e3)).toString(16),t;return o++,o>65535&&(o=1024),t=y(b+r+o),f+e+t.slice(0,4)+e+t.slice(4,8)+e+t.slice(-8)}function y(e,r){return typeof e=="number"&&(e+=""),typeof e=="string"||Buffer.isBuffer(e)?p.hash("md5",e,r):e}function K(e){if(l.accessSync(e,l.constants.R_OK)){var r=l.readFileSync(e);return p.hash("md5",r)}return null}function M(e,r){return typeof e=="number"&&(e+=""),typeof e=="string"||Buffer.isBuffer(e)?p.hash("sha1",e,r):e}function R(e){if(l.accessSync(e,l.constants.R_OK)){var r=l.readFileSync(e);return p.hash("sha1",r)}return null}function w(e,r){return typeof e=="number"&&(e+=""),typeof e=="string"||Buffer.isBuffer(e)?p.hash("sha256",e,r):e}function C(e){if(l.accessSync(e,l.constants.R_OK)){var r=l.readFileSync(e);return p.hash("sha256",r)}return null}var F=p;export{d as base64decode,A as base64encode,F as default,y as md5,K as md5Sign,D as rand,M as sha1,R as sha1Sign,w as sha256,C as sha256Sign,H as uuid};
